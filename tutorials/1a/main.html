
<!-- Step title -->
<h1>Stap 1a</h1>

<!-- Step preface -->
<span id="step-1a-preface">
  <p> In stap 1 zullen we kennis maken met een if statement. In de volgende delen
      zullen we zien wat: </p>
      <div class="ui bulleted list">
        <div class="item">  Een voorwaarde is. </div>
        <div class="item">  Een actie is. </div>
        <div class="item">  Waarom 'if' zo belangrijk is. </div>
        <div class="item">  Hoe we een 'if' maken met blokjes. </div>
      </div>
      <div class="ui buttons">
        <button id="step-1a-preface-btn" class="ui teal button">
          Verder
        </button>
      </div>
</span>

<span id="step-1a-part-1">
  <p> Een voorwaarde is een gegeven dat waar of fout kan zijn. Hieronder vind je
      enkele algemene voorbeelden van voorwaarden. Weet jij welke waar zijn? </p>
      <div class="ui bulleted list">
        <div class="item">  De zon schijnt. </div>
        <div class="item">  Het is 11u. </div>
        <div class="item">  Ik heb een Aas in mijn hand. </div>
        <div class="item">  De flop is nog niet gedeeld. </div>
      </div>
      <div class="ui buttons">
        <button id="step-1a-part-1-btn" class="ui teal button">
          Verder
        </button>
      </div>
</span>
<span id="step-1a-part-2">
  <p> Naast voorwaarden zijn er ook acties. Een actie is iets, zoals het woord al
      doet vermoeden, wat uitgevoerd kan worden. Hier zijn ook weer enkele
      voorbeelden van hedendaagse acties: </p>
      <div class="ui bulleted list">
        <div class="item">  Ik fiets. </div>
        <div class="item">  Jij maakt een examen. </div>
        <div class="item">  Wij gaan zitten op een bank. </div>
        <div class="item">  Ik call. </div>
      </div>
      <div class="ui buttons">
        <button id="step-1a-part-2-btn" class="ui teal button">
          Verder
        </button>
      </div>
</span>
<span id="step-1a-part-3">
  <p> Kijk maar eens rond tussen de blokjes om gewend te raken aan hun structuur.
      Zo kun je verschillende voorwaarden terugvinden onder 'voorwaarden' en
      acties onder 'acties'. </p>
  <p> Dankzij de 'if' kunnen we nu keuzes maken en een verband leggen tussen
      deze voorwaardes en acties. We kunnen bijvoorbeeld zeggen: 'Indien de zon
      schijnt, ga ik fietsen'. </p>
      <div class="ui buttons">
        <button id="step-1a-part-3-btn" class="ui teal button">
          Verder
        </button>
      </div>
</span>

<script>

</script>

<!-- Step description -->
<span id="step-1a-description">
  <p> Probeer nu zelf eens een 'if' te maken met de gegeven blokjes die het
      volgende voorstelt: 'Als het preflop is, dan call ik'. Je kan hier
      gebruik maken van: </p>
      <div class="ui bulleted list">
        <div class="item">  Een 'is preflop' voorwaarde. </div>
        <div class="item">  Een 'call' actie. </div>
        <div class="item">  Een 'if' statement. </div>
      </div>
      <div class="ui buttons">
        <button id="step-1a-tips-btn" class="ui green button">
          Toon tip
        </button>
        <div class="or" data-text="of"></div>
        <button id="step-1a-resign-btn" class="ui red button">
          Geef op
        </button>
      </div>
</span>

<!-- Step success -->
<span id="step-1a-success">
  <span class="congrats">Gefeliciteerd!</span>
  <p> De regel die je hebt aangemaakt is correct. In stap 1b zullen we ook
      rekening houden indien het niet preflop is. </p>
      <i class="huge yellow trophy icon"></i><br /><br /><br />
      <button class="ui small grey button" onclick="step1AChecker.next()">
        Volgende stap!
      </button>
</span>

<!-- Step fail -->
<span id="step-1a-fail">
  <span class="congrats">Oops!</span>
  <p> Probeer nu eens zelf deze oplossing na te maken. Het is belangrijk dat je
      dit voorbeeld goed snapt voor de volgende stappen.</p>
  <div><img id="step-1a-solution-preview" height='100' class="solution" src="tutorials/1a/solution.png" />
  </div>
  <button id="step-1a-restart-btn" class="ui small grey button">
    Probeer opnieuw!
  </button>
</span>

<!-- Step tips -->
<div id="step-1a-tips" class="ui dimmer">
  <div class="content">
    <div class="center">
      <h2 class="ui inverted icon header">
        <i class="help icon"></i>
        Tip
      </h2>
      <p id="step-1a-tip-text" class="diminfo"></p>
      <div id="step-1a-hide-tips-btn" class="ui grey button">
        Bedankt!
      </div>
    </div>
  </div>
</div>

<script>

  /**
   *  Shows the description div and hides all others, updates CSS.
   */
  var show1ADescription = function() {
    $('#step-1a-description').show();
    $('#step-1a-success').hide();
    $('#step-1a-fail').hide();
    $('#bargraph').addClass('tutorialinfo');
    $('#bargraph').removeClass('tutorialsuccess');
    $('#bargraph').removeClass('tutorialfailed');
    $('#step-1a-tips').dimmer('hide');
    step1AChecker.isStarted = true;
  }

  /**
   *  Shows the success div and hides all others, updates CSS.
   */
  var show1ASuccess = function() {
    $('#step-1a-description').hide();
    $('#step-1a-success').show();
    $('#step-1a-fail').hide();
    $('#bargraph').removeClass('tutorialinfo');
    $('#bargraph').addClass('tutorialsuccess');
    $('#bargraph').removeClass('tutorialfailed');
    $('#step-1a-tips').dimmer('hide');
  }

  /**
   *  Shows the fail div and hides all others, updates CSS.
   */
  var show1AFail = function() {
    $('#step-1a-description').hide();
    $('#step-1a-success').hide();
    $('#step-1a-fail').show();
    $('#bargraph').removeClass('tutorialinfo');
    $('#bargraph').removeClass('tutorialsuccess');
    $('#bargraph').addClass('tutorialfailed');
    $('#step-1a-tips').dimmer('hide');
  }

  /**
   *  Shows the tips view.
   */
  var show1ATips = function() {
    $('#step-1a-tips').dimmer('show');
  }

  /**
   *  Hides the tips view.
   */
  var hide1ATips = function() {
    $('#step-1a-tips').dimmer('hide');
  }

  /**
   *  Checks if the step is completed and makes sure it does not happen
   *  multiple times.
   */
  var step1AChecker = {
    isCompleted: false,
    isStarted: false,
    complete: function() {
      if (!this.isStarted) { return; }
      if (!this.isCompleted) {
        UIHANDLER.disableFullscreenWorkspace();
        show1ASuccess();
      }
      this.isCompleted = true;
    },
    next: function() {
      show1ADescription();
      $('#bargraph').load('tutorials/1b/main.html');
    }
  }

  /**
   *  Add listener to check if the new blocks are correct for this step.
   */
  var solution1A;
  $.get('tutorials/1a/solution.xml', function(data) {
    solution1A = Utils.xmlToString(data);
    workspace.addChangeListener(function () {
      var xml = Blockly.Xml.workspaceToDom(workspace);
      var provided = Blockly.Xml.domToText(xml);
      if (Utils.equalBlocks(provided, solution1A)) { step1AChecker.complete(); }
    });
  });

  $('#step-1a-hide-tips-btn').click(function(e) {
    hide1ATips();
  });

  $('#step-1a-resign-btn').click(function(e) {
    show1AFail();
  });

  $('#step-1a-restart-btn').click(function(e) {
    show1ADescription();
  });

  $('#step-1a-solution-preview').click(function(e) {
    $('#solution-zoom-img').attr('src', 'tutorials/1a/solution.png');
    $('#solution-zoom').dimmer('show');
  });

  /* New part for multiple steps */

  var step1ATips = [{
      valid: function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        var count = (provided.match(/is_preflop/g) || []).length;
        return count < 1;
      },
      text: 'Je hebt de \'is preflop\' voorwaarde nog niet toegevoegd aan je\
                workspace. Deze heb je echter wel nodig. Je kan het vinden onder\
                \'voorwaarden\' in de toolbox aan de linkerkant.'
    },{
      valid: function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        var count = (provided.match(/is_preflop/g) || []).length;
        return count > 1;
      },
      text: 'Je hebt meerdere \'is preflop\' voorwaarden toegevoegd aan je \
            workspace. Om deze opdracht te voltooien heb je echter maar één \
            keer dit blok nodig! Je kan de andere gerust verwijderen.'
    },{
      valid: function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        var count = (provided.match(/poker_call/g) || []).length;
        return count < 1;
      },
      text: 'Je hebt de \'call\' actie nog niet toegevoegd aan je\
                workspace. Deze heb je echter wel nodig. Je kan het vinden onder\
                \'acties\' in de toolbox aan de linkerkant.'
    },{
      valid: function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        var count = (provided.match(/poker_call/g) || []).length;
        return count > 1;
      },
      text: 'Je hebt meerdere \'call\' voorwaarden toegevoegd aan je \
            workspace. Om deze opdracht te voltooien heb je echter maar één \
            keer dit blok nodig! Je kan de andere gerust verwijderen.'
    },{
      valid: function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        var count = (provided.match(/custom_if/g) || []).length;
        return count < 1;
      },
      text: 'Je hebt de \'if\' nog niet toegevoegd aan je\
                workspace. Deze heb je echter wel nodig. Je kan het vinden onder\
                \'if\' in de toolbox aan de linkerkant.'
    },{
      valid: function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        var count = (provided.match(/custom_if/g) || []).length;
        return count > 1;
      },
      text: 'Je hebt meerdere \'if\' statements toegevoegd aan je \
            workspace. Om deze opdracht te voltooien heb je echter maar één \
            keer dit blok nodig! Je kan de andere gerust verwijderen.'
    },{
      valid: function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        var count = (provided.match(/block/g) || []).length;
        return count > 6;
      },
      text: ' Je hebt te veel blokken in je workspace, probeer er enkele te\
              verwijderen. Dit zal je workspace zo compact mogelijk houden.'
    },{
      valid: function() {
        return true;
      },
      text: ' Je hebt alle blokken al gevonden, je moet ze enkel nog op de juiste\
              manier in elkaar zien te puzzelen!'
    }
  ];

  $('#step-1a-tips-btn').click(function(e) {
    for(var i = 0; i < step1ATips.length; i++) {
      var tip = step1ATips[i];
      if (tip.valid()) {
        $('#step-1a-tip-text').html(tip.text);
        i = step1ATips.length;
      }
    }
    show1ATips();
  });

  $('#step-1a-part-1').hide();
  $('#step-1a-part-2').hide();
  $('#step-1a-part-3').hide();
  $('#step-1a-description').hide();
  $('#step-1a-preface-btn').click(function(e) {
    $('#step-1a-preface').hide();
    $('#step-1a-part-1').show();
  });
  $('#step-1a-part-1-btn').click(function(e) {
    $('#step-1a-part-1').hide();
    $('#step-1a-part-2').show();
  });
  $('#step-1a-part-2-btn').click(function(e) {
    $('#step-1a-part-2').hide();
    $('#step-1a-part-3').show();
  });
  $('#step-1a-part-3-btn').click(function(e) {
    $('#step-1a-part-3').hide();
    show1ADescription();
    workspace.clear();
  });

</script>
