
<!-- Step title -->
<h1>Stap 4b</h1>

<!-- Step description -->
<span id="step-4b-description">
  <p> We moeten het vorige probleem nu proberen op te lossen. Dit is mogelijk
      door eerst na te gaan of er een three of a kind ligt en dan pas te kijken
      of er een paar aanwezig is. Zie je waarom? Probeer dit maar eens! </p>
      <div class="ui buttons">
        <button id="step-4b-tips-btn" class="ui green button">
          Toon tip
        </button>
        <div class="or" data-text="of"></div>
        <button id="step-4b-resign-btn" class="ui red button">
          Geef op
        </button>
      </div>
</span>

<!-- Step success -->
<span id="step-4b-success">
  <span class="congrats">Gefeliciteerd!</span>
  <p> Je bent er helemaal klaar voor! In stap 5 is het de bedoeling een automatische
      pokerbot te verslaan. Je bent nu op een punt gekoment dat je genoeg weet
      om dit voor elkaar te krijgen. Toch te moeilijk? Kijk eens bij je buur! Veel geluk! </p>
      <button class="ui small grey button" onclick="step4BChecker.next()">
        Laat maar komen!
      </button>
</span>

<!-- Step fail -->
<span id="step-4b-fail">
  <span class="congrats">Oops!</span>
  <p> We laten jou dan wel de oplossing zien, maar we raden toch aan om deze
      stap opnieuw te proberen. Het is belangrijk dat je de stappen zelf maakt
      om zo vertrouwd te raken met het maken van verschillende regels. </p>
  <div><img id="step-4b-solution-preview" width='150' class="solution" src="tutorials/4b/solution.png" />
  </div>
  <button id="step-4b-restart-btn" class="ui small grey button">
    Probeer opnieuw!
  </button>
</span>

<!-- Step tips -->
<div id="step-4b-tips" class="ui dimmer">
  <div class="content">
    <div class="center">
      <h2 class="ui inverted icon header">
        <i class="help icon"></i>
        Tip
      </h2>
      <p class="diminfo"> Je kan simpelweg het tweede if statement boven het eerste
          plaatsen! Let wel op dat de onderste actie onderaan blijft. </p>
      <div id="step-4b-hide-tips-btn" class="ui grey button">
        Bedankt!
      </div>
    </div>
  </div>
</div>

<script>

  /**
   *  Shows the description div and hides all others, updates CSS.
   */
  var show4BDescription = function() {
    $('#step-4b-description').show();
    $('#step-4b-success').hide();
    $('#step-4b-fail').hide();
    $('#bargraph').addClass('tutorialinfo');
    $('#bargraph').removeClass('tutorialsuccess');
    $('#bargraph').removeClass('tutorialfailed');
    $('#step-4b-tips').dimmer('hide');
  }

  /**
   *  Shows the success div and hides all others, updates CSS.
   */
  var show4BSuccess = function() {
    $('#step-4b-description').hide();
    $('#step-4b-success').show();
    $('#step-4b-fail').hide();
    $('#bargraph').removeClass('tutorialinfo');
    $('#bargraph').addClass('tutorialsuccess');
    $('#bargraph').removeClass('tutorialfailed');
    $('#step-4b-tips').dimmer('hide');
  }

  /**
   *  Shows the fail div and hides all others, updates CSS.
   */
  var show4BFail = function() {
    $('#step-4b-description').hide();
    $('#step-4b-success').hide();
    $('#step-4b-fail').show();
    $('#bargraph').removeClass('tutorialinfo');
    $('#bargraph').removeClass('tutorialsuccess');
    $('#bargraph').addClass('tutorialfailed');
    $('#step-4b-tips').dimmer('hide');
  }

  /**
   *  Shows the tips view.
   */
  var show4BTips = function() {
    $('#step-4b-tips').dimmer('show');
  }

  /**
   *  Hides the tips view.
   */
  var hide4BTips = function() {
    $('#step-4b-tips').dimmer('hide');
  }

  /**
   *  Checks if the step is completed and makes sure it does not happen
   *  multiple times.
   */
  var step4BChecker = {
    isCompleted: false,
    complete: function() {
      if (!this.isCompleted) {
        UIHANDLER.disableFullscreenWorkspace();
        show4BSuccess();
      }
      this.isCompleted = true;
    },
    next: function() {
      show4BDescription();
      $('#bargraph').load('tutorials/5/main.html');
    }
  }

  /**
   *  Add listener to check if the new blocks are correct for this step.
   */
  var solution4B1;
  var solution4B2;
  $.get('tutorials/4b/solution1.xml', function(data) {
    solution4B1 = data;
    $.get('tutorials/4b/solution2.xml', function(data) {
      solution4B2 = data;
      workspace.addChangeListener(function() {
        var xml = Blockly.Xml.workspaceToDom(workspace);
        var provided = Blockly.Xml.domToText(xml);
        if (BlockChecker.equals(provided, solution4B1) || BlockChecker.equals(provided, solution4B2)) { step4BChecker.complete(); }
      });
    });
  });

  $('#step-4b-tips-btn').click(function(e) {
    show4BTips();
  });

  $('#step-4b-hide-tips-btn').click(function(e) {
    hide4BTips();
  });

  $('#step-4b-resign-btn').click(function(e) {
    show4BFail();
  });

  $('#step-4b-restart-btn').click(function(e) {
    show4BDescription();
  });

  $('#step-4b-solution-preview').click(function(e) {
    $('#solution-zoom-img').attr('src', 'tutorials/4b/solution.png');
    $('#solution-zoom').dimmer('show');
  });

</script>
