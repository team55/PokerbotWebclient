
<!--  In order to load this file into the main page, make sure that the
      Highcharts library is included before this file. If this is not the
      case, the charts won't render and might even cause all the JS to
      stop executing on the parent page.
      TODO: Include it here? But might cause problems with multiple
            includes in different modules.
      INCLUDE SCRIPTS/HIGHCHARTS.JS   -->

<canvas id="CalculationTime" width="100" height="100"></canvas>
<script>

  /**
   *  Define the CalculationTimeChart here!
   *  All the data will be loaded afterwards.
   */
/*
  var calculationTimeChart = new Highcharts.Chart({
    chart: {
      renderTo: 'CalculationTimeChart',
      type: 'pie'
    },
    title: {
      text: 'Rekentijd per speler'
    },
    series: [{
      type: 'pie',
      name: 'Times',
      data: []
    }],
    plotOptions: {
      pie: { shadow: false }
    }
  });
*/

/*
  var COLORS = [
    'rgb(25, 180, 145)',
    'rgb(41, 197, 102)',
    'rgb(45, 141, 214)',
    'rgb(144, 79, 173)',
    'rgb(46, 64, 83)',
    'rgb(22, 150, 122)',
    'rgb(35, 164, 85)',
    'rgb(36, 117, 176)',
    'rgb(131, 60, 163)',
    'rgb(39, 54, 70)'
  ];

  function createCalculationTimePieChart(data) {
    var information = {
      labels: [],
      datasets: [{
        data: [],
        backgroundColor: []
      }]
    };
    var i = 0;
    for(index in data) {
      information['labels'].push(index);
      information['datasets'][0]['data'].push(data[index]);
      information['datasets'][0]['backgroundColor'].push(COLORS[i]);
      i++;
    }
    var ctx = $('#CalculationTime');
    document.getElementById("CalculationTime").getContext("2d").clearRect(0, 0, 1000, 1000);
    var calculationTimePieChart = new Chart(ctx, {
      type: 'pie',
      data: information,
      tooltip: { enabled: false },
      options: {
        tooltips: {
          enabled: false
        },
        animation: {
          animateRotate: false
        }
      }
    });
  }

  function parseCalculationTimePieChartData(raw) {
    var list = raw['result']['player'];
    var result = {};
    for(var i = 0; i < list.length; i++) {
      result[list[i]['name']] = list[i]['time used'];
    }
    createCalculationTimePieChart(result);
  }

  function fetchCalculationTimePieChartData() {
    $.ajax({ url: DATASOURCE, method: 'GET', success: function(result) {
      try {
        var data = $.parseJSON(result);
        parseCalculationTimePieChartData(data);
      } catch(error) {
        console.error('Data received but error!: ' + error);
      }
    }, error: function(error) {
      console.error('Unable to fetch data!: ' + error);
    }});
  }

  setInterval(function() {
    fetchCalculationTimePieChartData();
  }, 2000);

  */

  var data = [
    {
        value: 300,
        color:"#F7464A",
        highlight: "#FF5A5E"
    },
    {
        value: 50,
        color: "#46BFBD",
        highlight: "#5AD3D1"
    },
    {
        value: 100,
        color: "#FDB45C",
        highlight: "#FFC870"
    }
]


var options = {}

var context = $('#CalculationTime').get(0).getContext('2d');
var chart = new Chart(context).Pie(data, options);



</script>
